{% extends 'base.html' %}

{% block title %}Available Animals - Animal Rescue{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>Available Animals</h1>
        <p>Find your perfect companion</p>
    </div>

    <div class="filters-section">
        <form method="get" class="filter-form">
            <div class="filter-group">
                <input type="text" name="search" placeholder="Search by name or breed..." value="{{ search }}" class="form-control">
            </div>
            <div class="filter-group">
                <select name="type" class="form-control">
                    <option value="">All Types</option>
                    <option value="dog" {% if animal_type == 'dog' %}selected{% endif %}>Dog</option>
                    <option value="cat" {% if animal_type == 'cat' %}selected{% endif %}>Cat</option>
                    <option value="bird" {% if animal_type == 'bird' %}selected{% endif %}>Bird</option>
                    <option value="rabbit" {% if animal_type == 'rabbit' %}selected{% endif %}>Rabbit</option>
                    <option value="other" {% if animal_type == 'other' %}selected{% endif %}>Other</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Filter</button>
            <a href="{% url 'animal_list' %}" class="btn btn-outline">Clear</a>
        </form>
    </div>

    <div class="animal-grid">
        {% for animal in page_obj %}
        <div class="animal-card">
            {% if animal.photo %}
                <img src="{{ animal.photo.url }}" alt="{{ animal.name }}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="no-image" style="display: none;">
                    <i class="fas fa-image"></i>
                </div>
            {% else %}
                <div class="no-image">
                    <i class="fas fa-image"></i>
                </div>
            {% endif %}
            <div class="animal-card-content">
                <h3>{{ animal.name }}</h3>
                <p class="animal-type">{{ animal.get_animal_type_display }}</p>
                <p class="animal-breed">{{ animal.breed|default:"Mixed breed" }}</p>
                {% if animal.age %}
                    <p class="animal-age">{{ animal.age }} years old</p>
                {% endif %}
                <a href="{% url 'animal_detail' animal.pk %}" class="btn btn-sm">View Details</a>
            </div>
        </div>
        {% empty %}
        <div class="no-results">
            <i class="fas fa-search"></i>
            <p>No animals found matching your criteria.</p>
        </div>
        {% endfor %}
    </div>

    {% if page_obj.has_other_pages %}
    <div class="pagination">
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}{% if search %}&search={{ search }}{% endif %}{% if animal_type %}&type={{ animal_type }}{% endif %}" class="btn">Previous</a>
        {% endif %}
        <span class="page-info">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% if search %}&search={{ search }}{% endif %}{% if animal_type %}&type={{ animal_type }}{% endif %}" class="btn">Next</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}


